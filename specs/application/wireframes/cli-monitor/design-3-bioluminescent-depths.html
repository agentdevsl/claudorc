<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AgentPane // Bioluminescent Depths — AI Agent Live Stream Monitor</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&family=Source+Code+Pro:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
/* ============================================
   BIOLUMINESCENT DEPTHS — Design 3 of 5
   Deep ocean bio-inspired AI monitoring
   ============================================ */

*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --abyss-black: #050510;
  --deep-ocean: #0a1628;
  --ocean-mid: #0d1f3c;
  --ocean-light: #112a4a;
  --bio-teal: #00ffd5;
  --bio-teal-dim: #00b396;
  --jellyfish-pink: #ff69b4;
  --jellyfish-pink-dim: #cc4490;
  --plankton-green: #39ff14;
  --plankton-green-dim: #28b30e;
  --deep-violet: #6a0dad;
  --deep-violet-light: #9b30ff;
  --amber-glow: #ffbf00;
  --water-blue: #1a3a5c;
  --text-primary: rgba(200, 230, 255, 0.9);
  --text-secondary: rgba(150, 190, 220, 0.6);
  --text-dim: rgba(100, 150, 190, 0.4);
}

html, body {
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: var(--abyss-black);
  font-family: 'Quicksand', sans-serif;
  color: var(--text-primary);
}

/* ============================================
   DEEP OCEAN BACKGROUND
   ============================================ */

#ocean-bg {
  position: fixed;
  inset: 0;
  z-index: 0;
  background: linear-gradient(
    180deg,
    #020208 0%,
    #050510 15%,
    #081020 35%,
    #0a1628 55%,
    #0d1f3c 75%,
    #0f2444 90%,
    #112a4a 100%
  );
}

/* Caustic light overlay */
#caustics-layer {
  position: fixed;
  inset: 0;
  z-index: 1;
  opacity: 0.08;
  pointer-events: none;
  background:
    radial-gradient(ellipse 300px 200px at 20% 80%, rgba(0, 255, 213, 0.3) 0%, transparent 70%),
    radial-gradient(ellipse 250px 180px at 70% 70%, rgba(0, 150, 255, 0.2) 0%, transparent 70%),
    radial-gradient(ellipse 400px 250px at 50% 90%, rgba(0, 200, 255, 0.15) 0%, transparent 70%);
  animation: causticShift 12s ease-in-out infinite alternate;
}

@keyframes causticShift {
  0% {
    background:
      radial-gradient(ellipse 300px 200px at 20% 80%, rgba(0, 255, 213, 0.3) 0%, transparent 70%),
      radial-gradient(ellipse 250px 180px at 70% 70%, rgba(0, 150, 255, 0.2) 0%, transparent 70%),
      radial-gradient(ellipse 400px 250px at 50% 90%, rgba(0, 200, 255, 0.15) 0%, transparent 70%);
  }
  33% {
    background:
      radial-gradient(ellipse 350px 220px at 30% 75%, rgba(0, 255, 213, 0.25) 0%, transparent 70%),
      radial-gradient(ellipse 280px 200px at 60% 85%, rgba(0, 150, 255, 0.25) 0%, transparent 70%),
      radial-gradient(ellipse 350px 230px at 45% 80%, rgba(0, 200, 255, 0.2) 0%, transparent 70%);
  }
  66% {
    background:
      radial-gradient(ellipse 280px 190px at 25% 85%, rgba(0, 255, 213, 0.35) 0%, transparent 70%),
      radial-gradient(ellipse 320px 210px at 75% 75%, rgba(0, 150, 255, 0.18) 0%, transparent 70%),
      radial-gradient(ellipse 380px 240px at 55% 85%, rgba(0, 200, 255, 0.22) 0%, transparent 70%);
  }
  100% {
    background:
      radial-gradient(ellipse 340px 210px at 18% 78%, rgba(0, 255, 213, 0.28) 0%, transparent 70%),
      radial-gradient(ellipse 260px 190px at 65% 80%, rgba(0, 150, 255, 0.22) 0%, transparent 70%),
      radial-gradient(ellipse 420px 260px at 48% 88%, rgba(0, 200, 255, 0.18) 0%, transparent 70%);
  }
}

/* Caustic pattern SVG overlay */
#caustic-pattern {
  position: fixed;
  inset: 0;
  z-index: 1;
  opacity: 0.04;
  pointer-events: none;
  overflow: hidden;
}

#caustic-pattern svg {
  width: 100%;
  height: 100%;
  animation: causticWarp 20s ease-in-out infinite alternate;
}

@keyframes causticWarp {
  0% { transform: scale(1) translate(0, 0); }
  50% { transform: scale(1.05) translate(-10px, 5px); }
  100% { transform: scale(0.98) translate(10px, -5px); }
}

/* ============================================
   PLANKTON PARTICLE CANVAS
   ============================================ */

#plankton-canvas {
  position: fixed;
  inset: 0;
  z-index: 2;
  pointer-events: none;
}

/* ============================================
   MAIN LAYOUT
   ============================================ */

#app {
  position: relative;
  z-index: 10;
  width: 100%;
  height: 100%;
  display: grid;
  grid-template-columns: 80px 1fr 220px;
  grid-template-rows: auto 1fr auto auto;
  grid-template-areas:
    "header header sonar"
    "depth organisms sonar"
    "depth stream stream"
    "status status status";
}

/* ============================================
   HEADER
   ============================================ */

#header {
  grid-area: header;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 24px 8px 24px;
  z-index: 20;
}

.header-title {
  font-family: 'Quicksand', sans-serif;
  font-weight: 300;
  font-size: 18px;
  letter-spacing: 4px;
  text-transform: uppercase;
  color: var(--bio-teal);
  text-shadow: 0 0 20px rgba(0, 255, 213, 0.4), 0 0 40px rgba(0, 255, 213, 0.15);
  animation: titleBreathe 6s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

@keyframes titleBreathe {
  0%, 100% { opacity: 0.85; text-shadow: 0 0 20px rgba(0, 255, 213, 0.4), 0 0 40px rgba(0, 255, 213, 0.15); }
  50% { opacity: 1; text-shadow: 0 0 30px rgba(0, 255, 213, 0.6), 0 0 60px rgba(0, 255, 213, 0.25); }
}

.header-subtitle {
  font-family: 'Source Code Pro', monospace;
  font-weight: 300;
  font-size: 11px;
  color: var(--text-dim);
  letter-spacing: 2px;
}

.header-right {
  display: flex;
  align-items: center;
  gap: 20px;
}

.live-indicator {
  display: flex;
  align-items: center;
  gap: 8px;
  font-family: 'Source Code Pro', monospace;
  font-size: 11px;
  color: var(--plankton-green);
  letter-spacing: 1px;
}

.live-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--plankton-green);
  box-shadow: 0 0 8px var(--plankton-green), 0 0 20px rgba(57, 255, 20, 0.4);
  animation: livePulse 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

@keyframes livePulse {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.4); opacity: 0.7; }
}

.session-time {
  font-family: 'Source Code Pro', monospace;
  font-size: 12px;
  color: var(--text-secondary);
  letter-spacing: 1px;
}

/* ============================================
   DEPTH GAUGE (LEFT PANEL)
   ============================================ */

#depth-gauge {
  grid-area: depth;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 12px 0;
  position: relative;
}

.depth-track {
  position: relative;
  width: 3px;
  flex: 1;
  background: linear-gradient(
    180deg,
    rgba(0, 255, 213, 0.05) 0%,
    rgba(0, 255, 213, 0.15) 50%,
    rgba(0, 255, 213, 0.05) 100%
  );
  border-radius: 2px;
  margin: 8px 0;
}

.depth-fill {
  position: absolute;
  top: 0;
  width: 100%;
  border-radius: 2px;
  background: linear-gradient(
    180deg,
    var(--bio-teal) 0%,
    var(--bio-teal-dim) 100%
  );
  box-shadow: 0 0 10px rgba(0, 255, 213, 0.5), 0 0 20px rgba(0, 255, 213, 0.2);
  transition: height 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.depth-marker {
  position: absolute;
  right: -6px;
  width: 15px;
  height: 3px;
  border-radius: 2px;
  background: var(--bio-teal);
  box-shadow: 0 0 8px rgba(0, 255, 213, 0.6);
  transition: top 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.depth-marker::after {
  content: '';
  position: absolute;
  right: -4px;
  top: -3px;
  width: 9px;
  height: 9px;
  border-radius: 50%;
  background: var(--bio-teal);
  box-shadow: 0 0 12px rgba(0, 255, 213, 0.8), 0 0 24px rgba(0, 255, 213, 0.3);
  animation: markerPulse 3s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

@keyframes markerPulse {
  0%, 100% { transform: scale(1); box-shadow: 0 0 12px rgba(0, 255, 213, 0.8), 0 0 24px rgba(0, 255, 213, 0.3); }
  50% { transform: scale(1.3); box-shadow: 0 0 16px rgba(0, 255, 213, 1), 0 0 32px rgba(0, 255, 213, 0.5); }
}

.depth-ticks {
  position: absolute;
  left: -28px;
  top: 0;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.depth-tick {
  font-family: 'Source Code Pro', monospace;
  font-size: 7px;
  color: var(--text-dim);
  letter-spacing: 0.5px;
  white-space: nowrap;
  text-align: right;
  width: 24px;
}

.depth-label-top, .depth-label-bottom {
  font-family: 'Source Code Pro', monospace;
  font-size: 8px;
  color: var(--text-dim);
  letter-spacing: 1px;
  text-transform: uppercase;
}

.depth-readings {
  position: absolute;
  left: 20px;
  bottom: 0;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.depth-reading {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.depth-reading-label {
  font-family: 'Source Code Pro', monospace;
  font-size: 7px;
  color: var(--text-dim);
  letter-spacing: 1px;
  text-transform: uppercase;
}

.depth-reading-value {
  font-family: 'Source Code Pro', monospace;
  font-size: 10px;
  font-weight: 500;
  color: var(--bio-teal);
  text-shadow: 0 0 8px rgba(0, 255, 213, 0.4);
}

/* ============================================
   AGENT ORGANISMS (CENTER)
   ============================================ */

#organisms-area {
  grid-area: organisms;
  position: relative;
  overflow: hidden;
  padding: 20px;
}

/* Connection threads between organisms */
#connection-threads {
  position: absolute;
  inset: 0;
  z-index: 1;
  pointer-events: none;
}

.connection-line {
  stroke-dasharray: 4 8;
  animation: dashFlow 4s linear infinite;
}

@keyframes dashFlow {
  to { stroke-dashoffset: -48; }
}

/* Individual organism */
.organism {
  position: absolute;
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: 5;
  cursor: pointer;
  transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.organism:hover {
  transform: scale(1.08);
}

.organism:hover .organism-body {
  filter: brightness(1.3);
}

.organism-body {
  position: relative;
  width: 80px;
  height: 80px;
  transition: filter 0.4s ease;
}

/* Organism glow aura */
.organism-aura {
  position: absolute;
  inset: -20px;
  border-radius: 50%;
  opacity: 0.3;
  filter: blur(20px);
  animation: auraPulse 4s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

@keyframes auraPulse {
  0%, 100% { transform: scale(1); opacity: 0.25; }
  50% { transform: scale(1.15); opacity: 0.4; }
}

/* Organism blob shape */
.organism-blob {
  position: absolute;
  inset: 0;
  border-radius: 42% 58% 55% 45% / 50% 45% 55% 50%;
  animation: blobMorph 8s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  opacity: 0.85;
  backdrop-filter: blur(2px);
}

@keyframes blobMorph {
  0% { border-radius: 42% 58% 55% 45% / 50% 45% 55% 50%; }
  25% { border-radius: 55% 45% 48% 52% / 45% 55% 48% 52%; }
  50% { border-radius: 48% 52% 42% 58% / 55% 48% 52% 45%; }
  75% { border-radius: 45% 55% 58% 42% / 48% 52% 45% 55%; }
  100% { border-radius: 42% 58% 55% 45% / 50% 45% 55% 50%; }
}

/* Inner glow nucleus */
.organism-nucleus {
  position: absolute;
  inset: 20px;
  border-radius: 50%;
  animation: nucleusPulse 3s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

@keyframes nucleusPulse {
  0%, 100% { transform: scale(0.9); opacity: 0.7; }
  50% { transform: scale(1.1); opacity: 1; }
}

/* Tentacle trails */
.organism-tentacles {
  position: absolute;
  bottom: -30px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 6px;
  opacity: 0.5;
}

.tentacle {
  width: 2px;
  height: 30px;
  border-radius: 0 0 2px 2px;
  animation: tentacleSway 5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
  transform-origin: top center;
}

.tentacle:nth-child(1) { animation-delay: 0s; height: 25px; }
.tentacle:nth-child(2) { animation-delay: 0.5s; height: 35px; }
.tentacle:nth-child(3) { animation-delay: 1s; height: 28px; }
.tentacle:nth-child(4) { animation-delay: 1.5s; height: 32px; }
.tentacle:nth-child(5) { animation-delay: 0.3s; height: 22px; }

@keyframes tentacleSway {
  0%, 100% { transform: rotate(-8deg) scaleY(1); }
  25% { transform: rotate(5deg) scaleY(0.9); }
  50% { transform: rotate(10deg) scaleY(1.05); }
  75% { transform: rotate(-3deg) scaleY(0.95); }
}

/* Organism info label */
.organism-info {
  margin-top: 38px;
  text-align: center;
  pointer-events: none;
}

.organism-name {
  font-family: 'Quicksand', sans-serif;
  font-weight: 500;
  font-size: 12px;
  letter-spacing: 1px;
  text-shadow: 0 0 10px currentColor;
  margin-bottom: 2px;
}

.organism-status {
  font-family: 'Source Code Pro', monospace;
  font-size: 9px;
  letter-spacing: 0.5px;
  opacity: 0.6;
}

/* Color variants */
.organism--teal .organism-aura { background: var(--bio-teal); }
.organism--teal .organism-blob {
  background: radial-gradient(ellipse at 40% 40%, rgba(0, 255, 213, 0.4) 0%, rgba(0, 179, 150, 0.2) 50%, rgba(0, 100, 85, 0.1) 100%);
  border: 1px solid rgba(0, 255, 213, 0.3);
  box-shadow: 0 0 20px rgba(0, 255, 213, 0.3), inset 0 0 20px rgba(0, 255, 213, 0.1);
}
.organism--teal .organism-nucleus {
  background: radial-gradient(circle, rgba(0, 255, 213, 0.8) 0%, rgba(0, 255, 213, 0) 70%);
}
.organism--teal .tentacle { background: linear-gradient(180deg, rgba(0, 255, 213, 0.4) 0%, transparent 100%); }
.organism--teal .organism-name { color: var(--bio-teal); }
.organism--teal .organism-status { color: var(--bio-teal-dim); }

.organism--pink .organism-aura { background: var(--jellyfish-pink); }
.organism--pink .organism-blob {
  background: radial-gradient(ellipse at 40% 40%, rgba(255, 105, 180, 0.4) 0%, rgba(204, 68, 144, 0.2) 50%, rgba(150, 40, 100, 0.1) 100%);
  border: 1px solid rgba(255, 105, 180, 0.3);
  box-shadow: 0 0 20px rgba(255, 105, 180, 0.3), inset 0 0 20px rgba(255, 105, 180, 0.1);
}
.organism--pink .organism-nucleus {
  background: radial-gradient(circle, rgba(255, 105, 180, 0.8) 0%, rgba(255, 105, 180, 0) 70%);
}
.organism--pink .tentacle { background: linear-gradient(180deg, rgba(255, 105, 180, 0.4) 0%, transparent 100%); }
.organism--pink .organism-name { color: var(--jellyfish-pink); }
.organism--pink .organism-status { color: var(--jellyfish-pink-dim); }

.organism--green .organism-aura { background: var(--plankton-green); }
.organism--green .organism-blob {
  background: radial-gradient(ellipse at 40% 40%, rgba(57, 255, 20, 0.35) 0%, rgba(40, 179, 14, 0.2) 50%, rgba(20, 100, 7, 0.1) 100%);
  border: 1px solid rgba(57, 255, 20, 0.25);
  box-shadow: 0 0 20px rgba(57, 255, 20, 0.25), inset 0 0 20px rgba(57, 255, 20, 0.1);
}
.organism--green .organism-nucleus {
  background: radial-gradient(circle, rgba(57, 255, 20, 0.8) 0%, rgba(57, 255, 20, 0) 70%);
}
.organism--green .tentacle { background: linear-gradient(180deg, rgba(57, 255, 20, 0.4) 0%, transparent 100%); }
.organism--green .organism-name { color: var(--plankton-green); }
.organism--green .organism-status { color: var(--plankton-green-dim); }

.organism--violet .organism-aura { background: var(--deep-violet-light); }
.organism--violet .organism-blob {
  background: radial-gradient(ellipse at 40% 40%, rgba(155, 48, 255, 0.35) 0%, rgba(106, 13, 173, 0.2) 50%, rgba(60, 7, 100, 0.1) 100%);
  border: 1px solid rgba(155, 48, 255, 0.3);
  box-shadow: 0 0 20px rgba(155, 48, 255, 0.3), inset 0 0 20px rgba(155, 48, 255, 0.1);
}
.organism--violet .organism-nucleus {
  background: radial-gradient(circle, rgba(155, 48, 255, 0.8) 0%, rgba(155, 48, 255, 0) 70%);
}
.organism--violet .tentacle { background: linear-gradient(180deg, rgba(155, 48, 255, 0.4) 0%, transparent 100%); }
.organism--violet .organism-name { color: var(--deep-violet-light); }
.organism--violet .organism-status { color: var(--deep-violet); }

/* Floating animation for each organism */
.organism--float-1 { animation: float1 7s cubic-bezier(0.4, 0, 0.2, 1) infinite; }
.organism--float-2 { animation: float2 9s cubic-bezier(0.4, 0, 0.2, 1) infinite; }
.organism--float-3 { animation: float3 8s cubic-bezier(0.4, 0, 0.2, 1) infinite; }
.organism--float-4 { animation: float4 10s cubic-bezier(0.4, 0, 0.2, 1) infinite; }
.organism--float-5 { animation: float5 11s cubic-bezier(0.4, 0, 0.2, 1) infinite; }

@keyframes float1 {
  0%, 100% { transform: translate(0, 0); }
  25% { transform: translate(8px, -12px); }
  50% { transform: translate(-5px, -20px); }
  75% { transform: translate(12px, -8px); }
}

@keyframes float2 {
  0%, 100% { transform: translate(0, 0); }
  25% { transform: translate(-10px, -8px); }
  50% { transform: translate(6px, -18px); }
  75% { transform: translate(-8px, -5px); }
}

@keyframes float3 {
  0%, 100% { transform: translate(0, 0); }
  25% { transform: translate(6px, -15px); }
  50% { transform: translate(-12px, -10px); }
  75% { transform: translate(4px, -22px); }
}

@keyframes float4 {
  0%, 100% { transform: translate(0, 0); }
  25% { transform: translate(-7px, -10px); }
  50% { transform: translate(10px, -15px); }
  75% { transform: translate(-4px, -6px); }
}

@keyframes float5 {
  0%, 100% { transform: translate(0, 0); }
  25% { transform: translate(5px, -18px); }
  50% { transform: translate(-8px, -8px); }
  75% { transform: translate(10px, -14px); }
}

/* ============================================
   SPECIMEN CARD (details on hover/click)
   ============================================ */

.specimen-card {
  position: absolute;
  z-index: 50;
  width: 260px;
  padding: 20px;
  border-radius: 32% 68% 60% 40% / 45% 55% 45% 55%;
  background: rgba(10, 22, 40, 0.85);
  backdrop-filter: blur(16px);
  border: 1px solid rgba(0, 255, 213, 0.15);
  opacity: 0;
  pointer-events: none;
  transform: scale(0.9) translateY(10px);
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.specimen-card.active {
  opacity: 1;
  pointer-events: auto;
  transform: scale(1) translateY(0);
  border-radius: 24px;
}

.specimen-card::before {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  padding: 1px;
  background: linear-gradient(135deg, rgba(0, 255, 213, 0.3) 0%, transparent 50%, rgba(155, 48, 255, 0.2) 100%);
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

.specimen-label {
  font-family: 'Quicksand', sans-serif;
  font-weight: 600;
  font-size: 9px;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: var(--text-dim);
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid rgba(0, 255, 213, 0.1);
}

.specimen-row {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 8px;
}

.specimen-key {
  font-family: 'Source Code Pro', monospace;
  font-size: 10px;
  color: var(--text-dim);
  letter-spacing: 0.5px;
}

.specimen-value {
  font-family: 'Source Code Pro', monospace;
  font-size: 11px;
  color: var(--text-primary);
  text-align: right;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.specimen-value--glow {
  text-shadow: 0 0 8px currentColor;
}

.specimen-activity {
  margin-top: 12px;
  padding-top: 10px;
  border-top: 1px solid rgba(0, 255, 213, 0.08);
  font-family: 'Source Code Pro', monospace;
  font-size: 10px;
  color: var(--text-secondary);
  line-height: 1.5;
  font-style: italic;
}

/* ============================================
   DATA CURRENT STREAM (BOTTOM CENTER)
   ============================================ */

#data-stream {
  grid-area: stream;
  position: relative;
  overflow: hidden;
  height: 120px;
  padding: 0 24px;
}

.stream-container {
  position: relative;
  width: 100%;
  height: 100%;
}

/* Fade edges */
#data-stream::before,
#data-stream::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  width: 80px;
  z-index: 10;
  pointer-events: none;
}

#data-stream::before {
  left: 0;
  background: linear-gradient(90deg, var(--abyss-black) 0%, transparent 100%);
}

#data-stream::after {
  right: 0;
  background: linear-gradient(-90deg, var(--abyss-black) 0%, transparent 100%);
}

.stream-item {
  position: absolute;
  white-space: nowrap;
  font-family: 'Source Code Pro', monospace;
  font-size: 11px;
  padding: 6px 14px;
  border-radius: 20px;
  background: rgba(0, 255, 213, 0.06);
  border: 1px solid rgba(0, 255, 213, 0.1);
  backdrop-filter: blur(4px);
  animation: streamDrift var(--drift-duration, 15s) linear forwards;
  opacity: 0;
}

.stream-item--tool {
  color: var(--bio-teal);
  border-color: rgba(0, 255, 213, 0.15);
  background: rgba(0, 255, 213, 0.08);
}

.stream-item--code {
  color: var(--plankton-green);
  border-color: rgba(57, 255, 20, 0.12);
  background: rgba(57, 255, 20, 0.06);
}

.stream-item--output {
  color: var(--jellyfish-pink);
  border-color: rgba(255, 105, 180, 0.12);
  background: rgba(255, 105, 180, 0.06);
}

.stream-item--thought {
  color: var(--deep-violet-light);
  border-color: rgba(155, 48, 255, 0.12);
  background: rgba(155, 48, 255, 0.06);
}

@keyframes streamDrift {
  0% {
    left: -200px;
    opacity: 0;
    transform: translateY(0) rotate(-1deg);
  }
  5% {
    opacity: 0.8;
  }
  50% {
    transform: translateY(-8px) rotate(0.5deg);
    opacity: 0.7;
  }
  90% {
    opacity: 0.3;
  }
  100% {
    left: calc(100% + 200px);
    opacity: 0;
    transform: translateY(4px) rotate(1deg);
  }
}

.stream-label {
  position: absolute;
  top: -2px;
  left: 24px;
  font-family: 'Quicksand', sans-serif;
  font-weight: 500;
  font-size: 10px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--text-dim);
  z-index: 15;
}

/* ============================================
   SONAR DISPLAY (RIGHT PANEL)
   ============================================ */

#sonar-panel {
  grid-area: sonar;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 16px 16px 16px 0;
  gap: 16px;
}

.sonar-container {
  position: relative;
  width: 190px;
  height: 190px;
}

.sonar-circle {
  position: absolute;
  border-radius: 50%;
  border: 1px solid rgba(0, 255, 213, 0.1);
}

.sonar-circle--outer {
  inset: 0;
}

.sonar-circle--mid {
  inset: 30px;
}

.sonar-circle--inner {
  inset: 60px;
}

.sonar-circle--core {
  inset: 80px;
  background: radial-gradient(circle, rgba(0, 255, 213, 0.15) 0%, transparent 70%);
}

/* Sonar crosshair lines */
.sonar-crosshair {
  position: absolute;
  inset: 0;
}

.sonar-crosshair::before,
.sonar-crosshair::after {
  content: '';
  position: absolute;
  background: rgba(0, 255, 213, 0.06);
}

.sonar-crosshair::before {
  left: 50%;
  top: 0;
  bottom: 0;
  width: 1px;
}

.sonar-crosshair::after {
  top: 50%;
  left: 0;
  right: 0;
  height: 1px;
}

/* Sonar sweep */
.sonar-sweep {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  animation: sonarSweep 4s linear infinite;
}

.sonar-sweep::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 50%;
  height: 2px;
  transform-origin: left center;
  background: linear-gradient(90deg, rgba(0, 255, 213, 0.6), transparent);
  box-shadow: 0 0 8px rgba(0, 255, 213, 0.3);
}

.sonar-sweep::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 50%;
  background: conic-gradient(
    from 0deg,
    transparent 0deg,
    rgba(0, 255, 213, 0.08) 15deg,
    transparent 60deg
  );
}

@keyframes sonarSweep {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Sonar pings */
.sonar-ping {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  transform: translate(-50%, -50%);
  animation: pingFade 3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.sonar-ping::after {
  content: '';
  position: absolute;
  inset: -4px;
  border-radius: 50%;
  border: 1px solid currentColor;
  opacity: 0.4;
  animation: pingRipple 2s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@keyframes pingFade {
  0% { opacity: 1; }
  70% { opacity: 0.8; }
  100% { opacity: 0; }
}

@keyframes pingRipple {
  0% { transform: scale(1); opacity: 0.4; }
  100% { transform: scale(3); opacity: 0; }
}

.sonar-ping--tool { background: var(--bio-teal); color: var(--bio-teal); box-shadow: 0 0 8px var(--bio-teal); }
.sonar-ping--complete { background: var(--plankton-green); color: var(--plankton-green); box-shadow: 0 0 8px var(--plankton-green); }
.sonar-ping--error { background: var(--jellyfish-pink); color: var(--jellyfish-pink); box-shadow: 0 0 8px var(--jellyfish-pink); }
.sonar-ping--event { background: var(--deep-violet-light); color: var(--deep-violet-light); box-shadow: 0 0 8px var(--deep-violet-light); }
.sonar-ping--amber { background: var(--amber-glow); color: var(--amber-glow); box-shadow: 0 0 8px var(--amber-glow); }

.sonar-title {
  font-family: 'Source Code Pro', monospace;
  font-size: 8px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--text-dim);
  text-align: center;
}

/* Sonar event log */
.sonar-log {
  flex: 1;
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 6px;
  overflow: hidden;
}

.sonar-log-item {
  font-family: 'Source Code Pro', monospace;
  font-size: 9px;
  color: var(--text-secondary);
  padding: 4px 8px;
  border-radius: 8px;
  background: rgba(0, 255, 213, 0.03);
  border-left: 2px solid transparent;
  opacity: 0;
  transform: translateX(20px);
  animation: logSlideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.sonar-log-item--tool { border-left-color: var(--bio-teal); }
.sonar-log-item--complete { border-left-color: var(--plankton-green); }
.sonar-log-item--error { border-left-color: var(--jellyfish-pink); }
.sonar-log-item--event { border-left-color: var(--deep-violet-light); }

@keyframes logSlideIn {
  to { opacity: 0.8; transform: translateX(0); }
}

.sonar-log-time {
  color: var(--text-dim);
  margin-right: 6px;
}

/* ============================================
   ECOSYSTEM METRICS (BUBBLES)
   ============================================ */

#ecosystem-metrics {
  position: absolute;
  bottom: 140px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 28px;
  z-index: 15;
}

.metric-bubble {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 110px;
  height: 90px;
  border-radius: 52% 48% 55% 45% / 48% 55% 45% 52%;
  background: rgba(10, 22, 40, 0.6);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(0, 255, 213, 0.1);
  animation: bubbleFloat 6s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

.metric-bubble:nth-child(2) { animation-delay: -2s; }
.metric-bubble:nth-child(3) { animation-delay: -4s; }
.metric-bubble:nth-child(4) { animation-delay: -1s; }

@keyframes bubbleFloat {
  0%, 100% { transform: translateY(0); border-radius: 52% 48% 55% 45% / 48% 55% 45% 52%; }
  50% { transform: translateY(-6px); border-radius: 48% 52% 45% 55% / 52% 48% 55% 45%; }
}

.metric-bubble::before {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  background: linear-gradient(135deg, rgba(0, 255, 213, 0.15) 0%, transparent 60%);
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  padding: 1px;
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

/* Inner glow for bubble */
.metric-bubble::after {
  content: '';
  position: absolute;
  inset: 10px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(0, 255, 213, 0.05) 0%, transparent 70%);
  animation: bubbleInnerGlow 4s ease-in-out infinite;
}

@keyframes bubbleInnerGlow {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 1; }
}

.metric-label {
  font-family: 'Quicksand', sans-serif;
  font-weight: 500;
  font-size: 9px;
  letter-spacing: 1px;
  text-transform: uppercase;
  color: var(--text-dim);
  z-index: 1;
}

.metric-value {
  font-family: 'Source Code Pro', monospace;
  font-weight: 600;
  font-size: 16px;
  color: var(--bio-teal);
  text-shadow: 0 0 12px rgba(0, 255, 213, 0.5);
  z-index: 1;
}

.metric-unit {
  font-family: 'Source Code Pro', monospace;
  font-size: 8px;
  color: var(--text-dim);
  letter-spacing: 0.5px;
  z-index: 1;
}

/* Mini organic sparkline chart */
.metric-chart {
  position: absolute;
  bottom: 8px;
  left: 50%;
  transform: translateX(-50%);
  width: 60px;
  height: 16px;
  z-index: 1;
}

.metric-chart svg {
  width: 100%;
  height: 100%;
}

.metric-chart path {
  fill: none;
  stroke-width: 1.5;
  stroke-linecap: round;
}

/* ============================================
   AMBIENT STATUS BAR (VERY BOTTOM)
   ============================================ */

#status-bar {
  grid-area: status;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 24px;
  padding: 10px 24px;
  font-family: 'Source Code Pro', monospace;
  font-size: 10px;
  color: var(--text-dim);
  letter-spacing: 2px;
  text-transform: uppercase;
  position: relative;
  overflow: hidden;
}

#status-bar::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(0, 255, 213, 0.1) 20%,
    rgba(0, 255, 213, 0.2) 50%,
    rgba(0, 255, 213, 0.1) 80%,
    transparent 100%
  );
  animation: statusLineWave 8s ease-in-out infinite;
}

@keyframes statusLineWave {
  0%, 100% {
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(0, 255, 213, 0.1) 20%,
      rgba(0, 255, 213, 0.2) 50%,
      rgba(0, 255, 213, 0.1) 80%,
      transparent 100%
    );
  }
  50% {
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(0, 255, 213, 0.15) 30%,
      rgba(0, 255, 213, 0.25) 60%,
      rgba(0, 255, 213, 0.1) 85%,
      transparent 100%
    );
  }
}

.status-item {
  display: flex;
  align-items: center;
  gap: 6px;
  animation: statusTextWave 6s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

.status-item:nth-child(2) { animation-delay: -1s; }
.status-item:nth-child(3) { animation-delay: -2s; }
.status-item:nth-child(4) { animation-delay: -3s; }
.status-item:nth-child(5) { animation-delay: -4s; }

@keyframes statusTextWave {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-1px); }
}

.status-separator {
  width: 3px;
  height: 3px;
  border-radius: 50%;
  background: rgba(0, 255, 213, 0.25);
  box-shadow: 0 0 4px rgba(0, 255, 213, 0.2);
}

.status-value {
  color: var(--bio-teal);
  text-shadow: 0 0 6px rgba(0, 255, 213, 0.3);
}

/* ============================================
   VIGNETTE & DEPTH FOG
   ============================================ */

#vignette {
  position: fixed;
  inset: 0;
  z-index: 3;
  pointer-events: none;
  background: radial-gradient(
    ellipse 70% 70% at 50% 50%,
    transparent 30%,
    rgba(5, 5, 16, 0.5) 70%,
    rgba(5, 5, 16, 0.9) 100%
  );
}

#depth-fog {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 120px;
  z-index: 3;
  pointer-events: none;
  background: linear-gradient(180deg, rgba(2, 2, 8, 0.8) 0%, transparent 100%);
}

/* ============================================
   RESPONSIVE ADJUSTMENTS
   ============================================ */

@media (max-width: 1200px) {
  #app {
    grid-template-columns: 60px 1fr 180px;
  }
  .sonar-container {
    width: 160px;
    height: 160px;
  }
}
</style>
</head>
<body>

<!-- Deep ocean background -->
<div id="ocean-bg"></div>

<!-- Caustic light pattern overlay -->
<div id="caustics-layer"></div>
<div id="caustic-pattern">
  <svg viewBox="0 0 800 600" preserveAspectRatio="none">
    <defs>
      <filter id="causticFilter">
        <feTurbulence type="fractalNoise" baseFrequency="0.015" numOctaves="3" seed="42">
          <animate attributeName="baseFrequency" values="0.015;0.02;0.015" dur="20s" repeatCount="indefinite" />
        </feTurbulence>
        <feDisplacementMap in="SourceGraphic" scale="40" />
      </filter>
      <radialGradient id="causticGrad" cx="50%" cy="80%" r="60%">
        <stop offset="0%" stop-color="rgba(0,200,255,0.3)" />
        <stop offset="100%" stop-color="transparent" />
      </radialGradient>
    </defs>
    <rect width="800" height="600" fill="url(#causticGrad)" filter="url(#causticFilter)" />
  </svg>
</div>

<!-- Plankton particle canvas -->
<canvas id="plankton-canvas"></canvas>

<!-- Vignette and depth fog overlays -->
<div id="vignette"></div>
<div id="depth-fog"></div>

<!-- Main Application -->
<div id="app">

  <!-- Header -->
  <header id="header">
    <div>
      <div class="header-title">AgentPane</div>
      <div class="header-subtitle">Bioluminescent Colony Monitor</div>
    </div>
    <div class="header-right">
      <div class="live-indicator">
        <span class="live-dot"></span>
        LIVE STREAM
      </div>
      <div class="session-time" id="session-time">00:24:17</div>
    </div>
  </header>

  <!-- Depth Gauge -->
  <div id="depth-gauge">
    <div class="depth-label-top">Surface</div>
    <div class="depth-track">
      <div class="depth-ticks">
        <span class="depth-tick">0m</span>
        <span class="depth-tick">500m</span>
        <span class="depth-tick">1000m</span>
        <span class="depth-tick">1500m</span>
        <span class="depth-tick">2000m</span>
        <span class="depth-tick">2500m</span>
        <span class="depth-tick">3000m</span>
      </div>
      <div class="depth-fill" id="depth-fill" style="height: 62%"></div>
      <div class="depth-marker" id="depth-marker" style="top: 62%"></div>
    </div>
    <div class="depth-label-bottom">Abyss</div>
  </div>

  <!-- Agent Organisms -->
  <div id="organisms-area">
    <!-- SVG Connection Threads -->
    <svg id="connection-threads" viewBox="0 0 100 100" preserveAspectRatio="none">
      <line class="connection-line" x1="25" y1="30" x2="50" y2="20" stroke="rgba(0,255,213,0.08)" stroke-width="0.3" />
      <line class="connection-line" x1="50" y1="20" x2="75" y2="35" stroke="rgba(0,255,213,0.06)" stroke-width="0.3" />
      <line class="connection-line" x1="25" y1="30" x2="40" y2="60" stroke="rgba(155,48,255,0.06)" stroke-width="0.3" />
      <line class="connection-line" x1="75" y1="35" x2="65" y2="65" stroke="rgba(255,105,180,0.06)" stroke-width="0.3" />
      <line class="connection-line" x1="40" y1="60" x2="65" y2="65" stroke="rgba(57,255,20,0.06)" stroke-width="0.3" />
      <line class="connection-line" x1="50" y1="20" x2="40" y2="60" stroke="rgba(0,255,213,0.04)" stroke-width="0.2" />
      <line class="connection-line" x1="50" y1="20" x2="65" y2="65" stroke="rgba(0,255,213,0.04)" stroke-width="0.2" />
      <line class="connection-line" x1="25" y1="30" x2="75" y2="35" stroke="rgba(155,48,255,0.04)" stroke-width="0.2" />
    </svg>

    <!-- Organism 1: Atlas (Active - Teal) -->
    <div class="organism organism--teal organism--float-1" style="left: 15%; top: 15%" data-agent="0" onclick="toggleSpecimen(0)">
      <div class="organism-body">
        <div class="organism-aura"></div>
        <div class="organism-blob" style="animation-delay: -2s;"></div>
        <div class="organism-nucleus"></div>
      </div>
      <div class="organism-tentacles">
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
      </div>
      <div class="organism-info">
        <div class="organism-name">Atlas</div>
        <div class="organism-status">executing</div>
      </div>
    </div>

    <!-- Organism 2: Meridian (Active - Teal) -->
    <div class="organism organism--teal organism--float-2" style="left: 42%; top: 5%" data-agent="1" onclick="toggleSpecimen(1)">
      <div class="organism-body">
        <div class="organism-aura"></div>
        <div class="organism-blob" style="animation-delay: -5s;"></div>
        <div class="organism-nucleus" style="animation-delay: -1s;"></div>
      </div>
      <div class="organism-tentacles">
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
      </div>
      <div class="organism-info">
        <div class="organism-name">Meridian</div>
        <div class="organism-status">executing</div>
      </div>
    </div>

    <!-- Organism 3: Helix (Planning - Pink) -->
    <div class="organism organism--pink organism--float-3" style="left: 68%; top: 12%" data-agent="2" onclick="toggleSpecimen(2)">
      <div class="organism-body">
        <div class="organism-aura"></div>
        <div class="organism-blob" style="animation-delay: -3s;"></div>
        <div class="organism-nucleus" style="animation-delay: -2s;"></div>
      </div>
      <div class="organism-tentacles">
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
      </div>
      <div class="organism-info">
        <div class="organism-name">Helix</div>
        <div class="organism-status">planning</div>
      </div>
    </div>

    <!-- Organism 4: Vortex (Waiting - Violet) -->
    <div class="organism organism--violet organism--float-4" style="left: 28%; top: 48%" data-agent="3" onclick="toggleSpecimen(3)">
      <div class="organism-body">
        <div class="organism-aura"></div>
        <div class="organism-blob" style="animation-delay: -7s;"></div>
        <div class="organism-nucleus" style="animation-delay: -3s;"></div>
      </div>
      <div class="organism-tentacles">
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
      </div>
      <div class="organism-info">
        <div class="organism-name">Vortex</div>
        <div class="organism-status">waiting</div>
      </div>
    </div>

    <!-- Organism 5: Coral (Completed - Green) -->
    <div class="organism organism--green organism--float-5" style="left: 58%; top: 50%" data-agent="4" onclick="toggleSpecimen(4)">
      <div class="organism-body">
        <div class="organism-aura"></div>
        <div class="organism-blob" style="animation-delay: -1s;"></div>
        <div class="organism-nucleus" style="animation-delay: -4s;"></div>
      </div>
      <div class="organism-tentacles">
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
        <div class="tentacle"></div>
      </div>
      <div class="organism-info">
        <div class="organism-name">Coral</div>
        <div class="organism-status">completed</div>
      </div>
    </div>

    <!-- Specimen Card (positioned dynamically) -->
    <div class="specimen-card" id="specimen-card">
      <div class="specimen-label">Specimen Analysis</div>
      <div class="specimen-row">
        <span class="specimen-key">Species</span>
        <span class="specimen-value" id="spec-species">--</span>
      </div>
      <div class="specimen-row">
        <span class="specimen-key">Class</span>
        <span class="specimen-value" id="spec-class">--</span>
      </div>
      <div class="specimen-row">
        <span class="specimen-key">Luminosity</span>
        <span class="specimen-value specimen-value--glow" id="spec-luminosity">--</span>
      </div>
      <div class="specimen-row">
        <span class="specimen-key">Health</span>
        <span class="specimen-value" id="spec-health">--</span>
      </div>
      <div class="specimen-row">
        <span class="specimen-key">Tokens</span>
        <span class="specimen-value" id="spec-tokens">--</span>
      </div>
      <div class="specimen-row">
        <span class="specimen-key">Turns</span>
        <span class="specimen-value" id="spec-turns">--</span>
      </div>
      <div class="specimen-activity" id="spec-activity">--</div>
    </div>
  </div>

  <!-- Ecosystem Metrics -->
  <div id="ecosystem-metrics">
    <div class="metric-bubble">
      <div class="metric-label">Colony</div>
      <div class="metric-value" id="metric-colony">5</div>
      <div class="metric-unit">active agents</div>
    </div>
    <div class="metric-bubble">
      <div class="metric-label">Biomass</div>
      <div class="metric-value" id="metric-biomass">24,847</div>
      <div class="metric-unit">total tokens</div>
    </div>
    <div class="metric-bubble">
      <div class="metric-label">Current</div>
      <div class="metric-value" id="metric-current">312</div>
      <div class="metric-unit">tok/s</div>
    </div>
    <div class="metric-bubble">
      <div class="metric-label">Tools</div>
      <div class="metric-value" id="metric-tools">147</div>
      <div class="metric-unit">invocations</div>
    </div>
  </div>

  <!-- Data Current Stream -->
  <div id="data-stream">
    <div class="stream-label">Data Current</div>
    <div class="stream-container" id="stream-container"></div>
  </div>

  <!-- Sonar Panel -->
  <div id="sonar-panel">
    <div class="sonar-container" id="sonar-container">
      <div class="sonar-circle sonar-circle--outer"></div>
      <div class="sonar-circle sonar-circle--mid"></div>
      <div class="sonar-circle sonar-circle--inner"></div>
      <div class="sonar-circle sonar-circle--core"></div>
      <div class="sonar-crosshair"></div>
      <div class="sonar-sweep"></div>
    </div>
    <div class="sonar-title">Event Sonar</div>
    <div class="sonar-log" id="sonar-log"></div>
  </div>

  <!-- Ambient Status Bar -->
  <div id="status-bar">
    <span class="status-item">AgentPane</span>
    <span class="status-separator"></span>
    <span class="status-item">Depth: <span class="status-value" id="status-depth">2,147m</span></span>
    <span class="status-separator"></span>
    <span class="status-item">Pressure: <span class="status-value" id="status-pressure">Nominal</span></span>
    <span class="status-separator"></span>
    <span class="status-item">Colony: <span class="status-value" id="status-colony">Active</span></span>
    <span class="status-separator"></span>
    <span class="status-item">Temp: <span class="status-value" id="status-temp">312 tok/s</span></span>
  </div>

</div>

<script>
// ============================================
// BIOLUMINESCENT DEPTHS — Interactive Engine
// ============================================

// --- Agent Data ---
const agents = [
  {
    name: 'Atlas',
    species: 'Agent-Atlas',
    class: 'Code Generation',
    status: 'executing',
    color: 'teal',
    luminosity: 847,
    health: 'Optimal',
    tokens: 8234,
    turns: 24,
    activity: 'Implementing authentication middleware with JWT token validation and refresh logic'
  },
  {
    name: 'Meridian',
    species: 'Agent-Meridian',
    class: 'Testing & QA',
    status: 'executing',
    color: 'teal',
    luminosity: 623,
    health: 'Optimal',
    tokens: 6102,
    turns: 18,
    activity: 'Writing integration tests for the user management API endpoints'
  },
  {
    name: 'Helix',
    species: 'Agent-Helix',
    class: 'Architecture',
    status: 'planning',
    color: 'pink',
    luminosity: 291,
    health: 'Stable',
    tokens: 4215,
    turns: 12,
    activity: 'Analyzing database schema for migration plan to support multi-tenancy'
  },
  {
    name: 'Vortex',
    species: 'Agent-Vortex',
    class: 'Infrastructure',
    status: 'waiting',
    color: 'violet',
    luminosity: 0,
    health: 'Dormant',
    tokens: 2891,
    turns: 8,
    activity: 'Queued: Awaiting worktree allocation for deployment pipeline setup'
  },
  {
    name: 'Coral',
    species: 'Agent-Coral',
    class: 'Documentation',
    status: 'completed',
    color: 'green',
    luminosity: 0,
    health: 'Completed',
    tokens: 3405,
    turns: 15,
    activity: 'Finished: Generated API documentation with OpenAPI spec and examples'
  }
];

// --- Plankton Particle System ---
const planktonCanvas = document.getElementById('plankton-canvas');
const planktonCtx = planktonCanvas.getContext('2d');
let planktonParticles = [];

function resizePlanktonCanvas() {
  planktonCanvas.width = window.innerWidth;
  planktonCanvas.height = window.innerHeight;
}
resizePlanktonCanvas();
window.addEventListener('resize', resizePlanktonCanvas);

class PlanktonParticle {
  constructor() {
    this.reset();
  }

  reset() {
    this.x = Math.random() * planktonCanvas.width;
    this.y = Math.random() * planktonCanvas.height;
    this.size = Math.random() * 2 + 0.3;
    this.speedX = (Math.random() - 0.5) * 0.3;
    this.speedY = (Math.random() - 0.5) * 0.15 - 0.05;
    this.opacity = Math.random() * 0.5 + 0.1;
    this.pulse = Math.random() * Math.PI * 2;
    this.pulseSpeed = Math.random() * 0.02 + 0.005;
    // Occasionally bioluminescent
    this.bioluminescent = Math.random() < 0.15;
    if (this.bioluminescent) {
      const colors = [
        [0, 255, 213],
        [57, 255, 20],
        [255, 105, 180],
        [155, 48, 255]
      ];
      this.color = colors[Math.floor(Math.random() * colors.length)];
      this.size = Math.random() * 1.5 + 1;
    } else {
      this.color = [150, 200, 230];
    }
    // Wave drift parameters
    this.waveAmplitude = Math.random() * 0.5 + 0.2;
    this.waveFrequency = Math.random() * 0.005 + 0.002;
    this.waveOffset = Math.random() * Math.PI * 2;
    this.time = 0;
  }

  update() {
    this.time += 1;
    this.pulse += this.pulseSpeed;
    const wave = Math.sin(this.time * this.waveFrequency + this.waveOffset) * this.waveAmplitude;
    this.x += this.speedX + wave * 0.1;
    this.y += this.speedY;

    if (this.x < -10 || this.x > planktonCanvas.width + 10 ||
        this.y < -10 || this.y > planktonCanvas.height + 10) {
      this.reset();
      if (Math.random() < 0.5) {
        this.x = Math.random() < 0.5 ? -5 : planktonCanvas.width + 5;
        this.y = Math.random() * planktonCanvas.height;
      } else {
        this.x = Math.random() * planktonCanvas.width;
        this.y = planktonCanvas.height + 5;
      }
    }
  }

  draw(ctx) {
    const pulseOpacity = this.opacity * (0.7 + 0.3 * Math.sin(this.pulse));
    const [r, g, b] = this.color;

    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${pulseOpacity})`;
    ctx.fill();

    if (this.bioluminescent) {
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.size * 3, 0, Math.PI * 2);
      const grad = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size * 3);
      grad.addColorStop(0, `rgba(${r}, ${g}, ${b}, ${pulseOpacity * 0.3})`);
      grad.addColorStop(1, `rgba(${r}, ${g}, ${b}, 0)`);
      ctx.fillStyle = grad;
      ctx.fill();
    }
  }
}

// Initialize plankton
for (let i = 0; i < 120; i++) {
  planktonParticles.push(new PlanktonParticle());
}

function animatePlankton() {
  planktonCtx.clearRect(0, 0, planktonCanvas.width, planktonCanvas.height);
  for (const p of planktonParticles) {
    p.update();
    p.draw(planktonCtx);
  }
  requestAnimationFrame(animatePlankton);
}
animatePlankton();


// --- Session Timer ---
let sessionSeconds = 24 * 60 + 17;
function updateSessionTime() {
  sessionSeconds++;
  const h = String(Math.floor(sessionSeconds / 3600)).padStart(2, '0');
  const m = String(Math.floor((sessionSeconds % 3600) / 60)).padStart(2, '0');
  const s = String(sessionSeconds % 60).padStart(2, '0');
  document.getElementById('session-time').textContent = `${h}:${m}:${s}`;
}
setInterval(updateSessionTime, 1000);


// --- Depth Gauge Animation ---
let currentDepth = 62;
function updateDepth() {
  const delta = (Math.random() - 0.4) * 3;
  currentDepth = Math.max(10, Math.min(95, currentDepth + delta));
  document.getElementById('depth-fill').style.height = currentDepth + '%';
  document.getElementById('depth-marker').style.top = currentDepth + '%';

  const depthMeters = Math.round(currentDepth * 30 + 200);
  document.getElementById('status-depth').textContent = depthMeters.toLocaleString() + 'm';
}
setInterval(updateDepth, 3000);


// --- Specimen Card ---
let activeSpecimen = -1;

function toggleSpecimen(index) {
  const card = document.getElementById('specimen-card');
  if (activeSpecimen === index) {
    card.classList.remove('active');
    activeSpecimen = -1;
    return;
  }

  activeSpecimen = index;
  const agent = agents[index];
  const organism = document.querySelectorAll('.organism')[index];
  const rect = organism.getBoundingClientRect();
  const areaRect = document.getElementById('organisms-area').getBoundingClientRect();

  // Position card near the organism
  let cardLeft = rect.right - areaRect.left + 16;
  let cardTop = rect.top - areaRect.top;

  // Keep card in view
  if (cardLeft + 280 > areaRect.width) {
    cardLeft = rect.left - areaRect.left - 280;
  }
  if (cardTop + 280 > areaRect.height) {
    cardTop = areaRect.height - 290;
  }

  card.style.left = cardLeft + 'px';
  card.style.top = Math.max(0, cardTop) + 'px';

  // Update card content
  document.getElementById('spec-species').textContent = agent.species;
  document.getElementById('spec-class').textContent = agent.class;
  document.getElementById('spec-luminosity').textContent = agent.luminosity + ' tok/min';
  document.getElementById('spec-luminosity').style.color =
    agent.color === 'teal' ? 'var(--bio-teal)' :
    agent.color === 'pink' ? 'var(--jellyfish-pink)' :
    agent.color === 'green' ? 'var(--plankton-green)' : 'var(--deep-violet-light)';
  document.getElementById('spec-health').textContent = agent.health;
  document.getElementById('spec-tokens').textContent = agent.tokens.toLocaleString();
  document.getElementById('spec-turns').textContent = agent.turns;
  document.getElementById('spec-activity').textContent = agent.activity;

  // Set card border glow color
  const colorMap = {
    teal: 'rgba(0, 255, 213, 0.2)',
    pink: 'rgba(255, 105, 180, 0.2)',
    green: 'rgba(57, 255, 20, 0.2)',
    violet: 'rgba(155, 48, 255, 0.2)'
  };
  card.style.boxShadow = `0 0 30px ${colorMap[agent.color]}, 0 0 60px ${colorMap[agent.color].replace('0.2', '0.08')}`;

  card.classList.add('active');
}

// Close specimen card when clicking outside
document.getElementById('organisms-area').addEventListener('click', function(e) {
  if (!e.target.closest('.organism') && !e.target.closest('.specimen-card')) {
    const card = document.getElementById('specimen-card');
    card.classList.remove('active');
    activeSpecimen = -1;
  }
});


// --- Data Stream ---
const streamData = [
  { type: 'tool', text: 'Read src/auth/middleware.ts' },
  { type: 'code', text: 'export function validateToken(req)' },
  { type: 'output', text: 'Test passed: auth.spec.ts (12/12)' },
  { type: 'thought', text: 'Analyzing schema dependencies...' },
  { type: 'tool', text: 'Bash: npm run test -- --watch' },
  { type: 'code', text: 'const schema = z.object({ email: z.string() })' },
  { type: 'output', text: 'Build successful: 0 errors, 2 warnings' },
  { type: 'tool', text: 'Grep: "createUser" --type ts' },
  { type: 'thought', text: 'Planning migration strategy...' },
  { type: 'code', text: 'async function handleWebhook(event)' },
  { type: 'tool', text: 'Write: src/services/user.service.ts' },
  { type: 'output', text: 'Coverage: 94.2% (+2.1%)' },
  { type: 'code', text: 'if (token.exp < Date.now()) throw new AuthError()' },
  { type: 'thought', text: 'Evaluating error handling patterns...' },
  { type: 'tool', text: 'Edit: src/routes/api/tasks.ts L42-58' },
  { type: 'output', text: 'Migration complete: 3 tables updated' },
  { type: 'code', text: 'router.post("/api/sessions", createSession)' },
  { type: 'tool', text: 'Glob: src/**/*.test.ts' },
  { type: 'thought', text: 'Cross-referencing API endpoints...' },
  { type: 'output', text: 'Lint: 0 issues found' },
  { type: 'code', text: 'interface TaskPayload { id: string; status: Status }' },
  { type: 'tool', text: 'Read: package.json' },
  { type: 'output', text: 'Deploy preview: https://preview-abc123.app' },
  { type: 'thought', text: 'Optimizing query performance...' },
];

let streamItemIndex = 0;

function addStreamItem() {
  const container = document.getElementById('stream-container');
  const data = streamData[streamItemIndex % streamData.length];
  streamItemIndex++;

  const item = document.createElement('div');
  item.className = `stream-item stream-item--${data.type}`;
  item.textContent = data.text;

  // Random vertical position within stream area
  const yPos = Math.random() * 70 + 10;
  item.style.top = yPos + 'px';

  // Vary drift duration
  const duration = 14 + Math.random() * 8;
  item.style.setProperty('--drift-duration', duration + 's');

  container.appendChild(item);

  // Clean up old items
  setTimeout(() => {
    if (item.parentNode) item.parentNode.removeChild(item);
  }, duration * 1000 + 500);
}

// Start stream with staggered initial items
for (let i = 0; i < 6; i++) {
  setTimeout(() => addStreamItem(), i * 800);
}
setInterval(addStreamItem, 2500);


// --- Sonar Pings ---
const sonarContainer = document.getElementById('sonar-container');
const sonarLog = document.getElementById('sonar-log');

const sonarEvents = [
  { type: 'tool', label: 'Tool: Read file' },
  { type: 'complete', label: 'Task completed' },
  { type: 'tool', label: 'Tool: Bash exec' },
  { type: 'event', label: 'Agent turn #25' },
  { type: 'tool', label: 'Tool: Edit file' },
  { type: 'amber', label: 'Token limit: 80%' },
  { type: 'tool', label: 'Tool: Grep search' },
  { type: 'event', label: 'Session checkpoint' },
  { type: 'error', label: 'Retry: rate limit' },
  { type: 'complete', label: 'Tests passing' },
  { type: 'tool', label: 'Tool: Write file' },
  { type: 'event', label: 'Plan approved' },
  { type: 'tool', label: 'Tool: Glob files' },
  { type: 'amber', label: 'Memory: 72%' },
  { type: 'tool', label: 'Tool: WebFetch' },
  { type: 'event', label: 'Agent turn #26' },
];

let sonarEventIndex = 0;

function addSonarPing() {
  const event = sonarEvents[sonarEventIndex % sonarEvents.length];
  sonarEventIndex++;

  // Create ping on sonar
  const ping = document.createElement('div');
  ping.className = `sonar-ping sonar-ping--${event.type}`;

  // Random position within sonar circle
  const angle = Math.random() * Math.PI * 2;
  const radius = Math.random() * 70 + 15;
  const cx = 95 + Math.cos(angle) * radius;
  const cy = 95 + Math.sin(angle) * radius;
  ping.style.left = cx + 'px';
  ping.style.top = cy + 'px';

  sonarContainer.appendChild(ping);
  setTimeout(() => {
    if (ping.parentNode) ping.parentNode.removeChild(ping);
  }, 3000);

  // Add to log
  const logItem = document.createElement('div');
  logItem.className = `sonar-log-item sonar-log-item--${event.type}`;
  const now = new Date();
  const timeStr = now.toTimeString().split(' ')[0].substring(3);
  logItem.innerHTML = `<span class="sonar-log-time">${timeStr}</span>${event.label}`;

  sonarLog.insertBefore(logItem, sonarLog.firstChild);

  // Keep log limited
  while (sonarLog.children.length > 12) {
    sonarLog.removeChild(sonarLog.lastChild);
  }
}

// Initial pings
for (let i = 0; i < 4; i++) {
  setTimeout(() => addSonarPing(), i * 600);
}
setInterval(addSonarPing, 3000);


// --- Metric Updates ---
let biomassTotal = 24847;
let currentSpeed = 312;
let toolCount = 147;

function updateMetrics() {
  // Biomass (total tokens)
  biomassTotal += Math.floor(Math.random() * 80 + 20);
  document.getElementById('metric-biomass').textContent = biomassTotal.toLocaleString();

  // Current speed (tok/s)
  currentSpeed += Math.floor(Math.random() * 40 - 18);
  currentSpeed = Math.max(180, Math.min(500, currentSpeed));
  document.getElementById('metric-current').textContent = currentSpeed;
  document.getElementById('status-temp').textContent = currentSpeed + ' tok/s';

  // Tools
  if (Math.random() > 0.4) {
    toolCount++;
    document.getElementById('metric-tools').textContent = toolCount;
  }

  // Pressure status based on speed
  const pressureEl = document.getElementById('status-pressure');
  if (currentSpeed > 400) {
    pressureEl.textContent = 'Elevated';
    pressureEl.style.color = 'var(--amber-glow)';
  } else if (currentSpeed > 300) {
    pressureEl.textContent = 'Nominal';
    pressureEl.style.color = 'var(--bio-teal)';
  } else {
    pressureEl.textContent = 'Low';
    pressureEl.style.color = 'var(--text-dim)';
  }

  // Update agent data (simulate activity)
  for (const agent of agents) {
    if (agent.status === 'executing') {
      agent.tokens += Math.floor(Math.random() * 30 + 10);
      agent.luminosity += Math.floor(Math.random() * 20 - 8);
      agent.luminosity = Math.max(400, Math.min(1200, agent.luminosity));
    }
  }

  // Update specimen card if visible
  if (activeSpecimen >= 0) {
    const agent = agents[activeSpecimen];
    document.getElementById('spec-luminosity').textContent = agent.luminosity + ' tok/min';
    document.getElementById('spec-tokens').textContent = agent.tokens.toLocaleString();
  }
}

setInterval(updateMetrics, 2500);


// --- Occasional organism state changes ---
const activities = {
  teal: [
    'Implementing authentication middleware with JWT token validation',
    'Refactoring database queries for connection pooling',
    'Building REST API endpoint for session management',
    'Writing WebSocket handler for real-time updates',
    'Optimizing build pipeline with code splitting',
  ],
  pink: [
    'Analyzing codebase architecture for migration plan',
    'Reviewing dependency graph for security vulnerabilities',
    'Planning database schema normalization strategy',
    'Evaluating state management approaches',
    'Designing error handling and recovery patterns',
  ],
};

function updateAgentActivity() {
  // Randomly update an active agent's activity
  const activeAgents = agents.filter(a => a.status === 'executing' || a.status === 'planning');
  if (activeAgents.length === 0) return;

  const agent = activeAgents[Math.floor(Math.random() * activeAgents.length)];
  const pool = agent.status === 'executing' ? activities.teal : activities.pink;
  agent.activity = pool[Math.floor(Math.random() * pool.length)];

  // Random turn increment for active agents
  if (agent.status === 'executing') {
    agent.turns += 1;
  }

  // Update specimen card if this agent is shown
  const idx = agents.indexOf(agent);
  if (activeSpecimen === idx) {
    document.getElementById('spec-activity').textContent = agent.activity;
    document.getElementById('spec-turns').textContent = agent.turns;
  }
}

setInterval(updateAgentActivity, 8000);


// --- Connection Thread Animation ---
// Make connection threads pulse occasionally
function pulseConnections() {
  const lines = document.querySelectorAll('.connection-line');
  const line = lines[Math.floor(Math.random() * lines.length)];
  const origOpacity = line.getAttribute('stroke').includes('0.08') ? 0.08 : 0.06;
  const brightOpacity = origOpacity * 4;
  const color = line.getAttribute('stroke').replace(/[\d.]+\)$/, brightOpacity + ')');
  line.setAttribute('stroke', color);
  line.setAttribute('stroke-width', '0.6');

  setTimeout(() => {
    const dimColor = line.getAttribute('stroke').replace(/[\d.]+\)$/, origOpacity + ')');
    line.setAttribute('stroke', dimColor);
    line.setAttribute('stroke-width', '0.3');
  }, 1500);
}

setInterval(pulseConnections, 4000);


// --- Occasional bioluminescent flash ---
// Random bright particle burst
function bioluminescentFlash() {
  const x = Math.random() * planktonCanvas.width;
  const y = Math.random() * planktonCanvas.height;
  const colors = [[0,255,213],[57,255,20],[255,105,180],[155,48,255]];
  const color = colors[Math.floor(Math.random() * colors.length)];

  // Create a brief cluster of bright particles
  for (let i = 0; i < 8; i++) {
    const p = new PlanktonParticle();
    p.x = x + (Math.random() - 0.5) * 30;
    p.y = y + (Math.random() - 0.5) * 30;
    p.color = color;
    p.bioluminescent = true;
    p.opacity = 0.8;
    p.size = Math.random() * 2 + 1;
    p.speedX = (Math.random() - 0.5) * 0.8;
    p.speedY = (Math.random() - 0.5) * 0.8;
    planktonParticles.push(p);
  }

  // Remove extra particles to maintain performance
  setTimeout(() => {
    while (planktonParticles.length > 140) {
      planktonParticles.shift();
    }
  }, 5000);
}

setInterval(bioluminescentFlash, 7000);
setTimeout(bioluminescentFlash, 2000);


// --- Deep Ambient Light Shimmer ---
// Occasionally vary the caustic layer opacity
let causticOpacity = 0.08;
function shimmerCaustics() {
  const target = 0.04 + Math.random() * 0.08;
  const step = (target - causticOpacity) / 30;
  let frame = 0;
  const causticLayer = document.getElementById('caustics-layer');

  function animate() {
    frame++;
    causticOpacity += step;
    causticLayer.style.opacity = causticOpacity;
    if (frame < 30) requestAnimationFrame(animate);
  }
  animate();
}
setInterval(shimmerCaustics, 5000);


// --- Keyboard shortcuts ---
document.addEventListener('keydown', function(e) {
  // Press 1-5 to select organisms
  if (e.key >= '1' && e.key <= '5') {
    toggleSpecimen(parseInt(e.key) - 1);
  }
  // Escape to close specimen card
  if (e.key === 'Escape') {
    document.getElementById('specimen-card').classList.remove('active');
    activeSpecimen = -1;
  }
});


// --- Initial log entries ---
const initialLogs = [
  { type: 'event', label: 'Session started' },
  { type: 'tool', label: 'Tool: Read config' },
  { type: 'complete', label: 'Init complete' },
];

initialLogs.forEach((event, i) => {
  setTimeout(() => {
    const logItem = document.createElement('div');
    logItem.className = `sonar-log-item sonar-log-item--${event.type}`;
    logItem.innerHTML = `<span class="sonar-log-time">00:00</span>${event.label}`;
    sonarLog.appendChild(logItem);
  }, i * 200);
});

</script>
</body>
</html>
